import{n as e,u as l,o as s,c as t,w as a,d as i,i as n,a as r,f as o,k as c,v as d,x as u,b as m,r as g,F as A,g as h,e as p,q as f,S as y,h as C,t as P}from"./index.1e554a58.js";import{_ as M,m as v}from"./MusicHeader.e4e9a46e.js";import{h as L}from"./request.bc33cf91.js";import{_ as G}from"./SQ.7f0d65f0.js";const T=M({data:()=>({paused:!0,commentList:null,song:null,recommendList:null,lyric:null,currentLine:0,bgAudioManager:null,timer:0}),methods:{handleClick(){this.paused=!this.paused,this.paused?this.bgAudioManager.pause():this.bgAudioManager.play(),this.clear()},gotoPlay(l){e({url:`/pages/play/play?id=${l}`})},listenLyric(){clearInterval(this.time),this.timer=setInterval((()=>{for(var e=0;e<this.lyric.length;e++){if(this.bgAudioManager.currentTime>this.lyric[this.lyric.length-1].time){this.currentLine=this.lyric.length-1;break}this.bgAudioManager.currentTime>this.lyric[e].time&&this.bgAudioManager.currentTime<this.lyric[e+1].time&&(this.currentLine=e)}}),300),console.log(this.timer)},clear(){clearInterval(this.timer)}},components:{musichead:v},onUnload:function(){var e;this.clear(),null==(e=this.bgAudioManager)||e.destroy()},onHide:function(){var e;this.clear(),null==(e=this.bgAudioManager)||e.destroy()},onLoad:function(e){let s=L({url:`/song/detail?ids=${e.id}`}),t=L({url:`/comment/music?id=${e.id}`}),a=L({url:`/simi/song?id=${e.id}`}),i=L({url:`/lyric?id=${e.id}`}),n=L({url:`/song/url?id=${e.id}`});Promise.all([s,t,a,i,n]).then((s=>{var t,a,i;this.song=s[0].data.songs[0],this.commentList=[...s[1].data.hotComments,...s[1].data.comments],this.recommendList=s[2].data.songs;let n=s[3].data.lrc.lyric,r=[];n.replace(/\[([^\]]+)]([^\[]+)/g,((e,l,s)=>{r.push({time:l,lyric:s})}));let o=r.map((e=>{return{time:(l=e.time,60*+l.split(":")[0]+ +(+l.split(":")[1]).toFixed(1)),lyric:e.lyric};var l}));this.lyric=o;const c=l();c.autoplay=!1,c.title=null==(t=this.song)?void 0:t.name,c.singer=null==(a=this.song)?void 0:a.ar[0].name,c.coverImgUrl=null==(i=this.song)?void 0:i.al.picUrl,c.src=s[4].data.data[0].url,c.onPlay((()=>{this.paused=!1,this.listenLyric()})),c.onPause((()=>{this.paused=!0,this.clear()})),c.onEnded((()=>{this.$store.commit("NEXT_ID",e.id)})),this.bgAudioManager=c}))},computed:{compCount:()=>e=>e>=1e4&&e<1e8?`${(e/=1e4).toFixed(1)}万`:e>=1e8?`${(e/=1e8).toFixed(1)}亿`:e}},[["render",function(e,l,M,v,L,T){const B=n,I=p("musichead"),k=f,U=y,_=C;return L.song?(s(),t(B,{key:0,class:"playPage"},{default:a((()=>[r(B,{class:"fixBg",style:o({backgroundImage:"url("+L.song.al.picUrl+")"})},null,8,["style"]),r(I,{title:L.song.name,icon:!0,color:"white",auth:L.song.ar[0].name},null,8,["title","auth"]),r(U,{"scroll-y":"true"},{default:a((()=>[r(B,{class:"wrapper"},{default:a((()=>[r(B,{class:"circle",onClick:T.handleClick},{default:a((()=>[r(k,{src:"/assets/needle.aa8566fe.png",mode:"widthFix",class:c(L.paused?"needle posi":"needle posi start")},null,8,["class"]),r(B,{class:"baseCircle posi"},{default:a((()=>[r(k,{src:L.song.al.picUrl,mode:"",class:c(L.paused?"songPic":"songPic ani")},null,8,["src","class"])])),_:1}),d(r(k,{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKgAAACoCAMAAABDlVWGAAABJlBMVEUAAAAAAAD////l5eX///9iYmKDg4Pn5+f///9YWFj////09PT////4+Pjt7e3///////9oaGhBQUH////////////////CwsIaGhr///8xMTEkJCT////7+/vp6en///////////////+srKyoqKienp58fHz////y8vKTk5P///8EBAT////////////////V1dW3t7f////////////////////v7++jo6N9fX3///////+UlJT////s7Oz////Nzc3///////+RkZGPj495eXkTExP////////29vb////k5OTPz882Njb////////////c3Nz///////9ycnJsbGz///9dXV3////////Q0ND///9QUFD///////////////////9FeiN6AAAAYXRSTlNmAP3c+oWT3ueB9vA19ealRId5EQbuurpu83RxD/nh05dfAquooo+M7JtzaSolE+vMspJ3Wj7w6KSQj6ucKeXNxLWnmpmObVYd8t3axXZRSt7TvbKLideCeSzHnn4V3Nh6YarbPAAABlRJREFUeNrU14lWEmEYh/GXcdj3HQTZRCkS913UNE2zbLd9Oc/930Q2LmVpwPAC03MD/M5835n/IC6dkqHnzcVoZvdkLp2HfHruZDcTXWw+DyVdOilAt6uNjI8782Ua1W2XjTShtdDSmzRdlH6zFKq5bKQBTS5H57gqXJrP1tsb7kShkBPJFQoJ90a7np0vhblqLrrc8R7oQ4vVPZOLIp8mp8flzsanJ59FuMjcqxZdHVKFxvYDWK1lPQXpooInu4ZVYD/m6pAWNLn0DSvvekJ6KLHuxerb0qyrQwrQViV/oZzKSc/lpi6sgUrLdSN16MyWARBcOBWbnS4EAYytj67r1KGtqMUseaSvPCWLGr14u+pDZysmwFhc+i4+BmBWZgcATTXTFvO9qOS3qOlmShu68g7A6xa13F6A7yuq0ORnA9jZENU2dgDjc1IPGvMB4QNR7+AJ4IspQVObBjDmF+Wur6qxmdKAbpeBoEcGlCcIlLf7hx7lOzxOlYeaP+oTmmoYQFsGWhswGql+oMUMEInLgItHgEzRPvS43OHYVY+/fGwXGvIBkzKU6oAvZA8aywOPZEg9AvIxO9AXAZg4lKF1OAGBF71DX5jw5EyG2NkTMJ/3Co2ZcM8tQ819D8xYb9CVgA2nijSw0gs0tArBzk59aRBWQ91Dj30QjssIiofBd9wttFiGiTMZSWcTUC52B629Bg5lRB0Cr2tdQRvAfRlZ94FGN9AjA+oywupgHHWGzuRhTEbaGORnOkFTZYj4ZaT5I1BOdYBuAnEZcXFg89/QmAFtGXltMGL/ghZ9I7+g19fUV/wHtAJBvzggfxAqd0NXDPCII/KAsXIXNPXOIQd/efjvUndAmxB2xMH/zB+G5u3Qr2k4EMd0AOmvt0IrsCMOagcqt0FbJkyLg5oGs3ULNApecVReiP4NnTHALY7KDcbHv6BbDno1XTUGW39CWwa8F4flB6P1B3TRgQ/UeqSLN6GzAQd83f1dHAKzN6AfoCQOrARLN6Andr9GpiITT9/KwPLAye/QGATFTusAxsOCDKogxH6D7sOC2GkNq+B9GVALsP8LWgzAqdjJ4LJXCRlIpxAoXkOrtteT6yYmH8gg8kL1GroHU/1CoTSQBZ6CvSto0oRc/1DM7GNRLwdm8hK6DF5RgMI9j6jnheVLaBTWdaAwPy7KrUP0Alqbg4QWlPCU6JaAuZoFDcGaqEHh6RdRLQIhC/oBsppQzAXVN1UWlixoBjyqUIhozr8H3vyE1lYhpwnVnv8CpH9CZyAi2lAIPtK8pDPn0Cp8UoWqz/8zqJ5DGzCpCdWf/0lonEMzMK0J1Z//acicQ30wrgnVn/9x8LkkCWFRherPfxiSEgKvLlR//r0QkmWY14Xqz/88LEsTsqpQ/fm3RlQWoa4L1Z//OixKFNq6UP35vw9RycDGMKAYD3P9vEhlF9y6UP35d8OuvISELlR//hPwUqxh0oTqz781TbIKueFB4em4rb/Mq5IfMpRn0nOPIS+ADBUatvcz/w/0B/X2VgMACMNQ9AMnWOADKwT/QuahyZYcDcte7e146X9W+vFmWmEzOeOJGfjMCmWOEubMYw7no7wizHPHvMuMAMFIOo5IxsiOjJDLSOOM2cDYN44hxliMjGnL2OAOWMCgGgz84uBEDKDFIG8ORLhzLPO2Y5kK6PpMdJiBsR28nQkMOBEMJtTixISY4JUTZWPCgVXevesgCINhGG7dZPLEIg7GRRsMTsaoMTEOnmLUuBgn+e//JuTHGt0aKT3y3QIFpj6vO9ctnbnAmr9PIysefn0E0PfhkjW92HFtnQHULn5AAG9aISZGF3NaQYxVrInRrcVYBW4H5vkPEPIfuIV5UGXhClHT8Qv9oXQ/MckoTfb+wVTGqK8ZUl9+4mmUnpGj03pOmzlH5y/w5w6ZiAil+G9qA0KpkfWMTxKsJ6530wel3try9CwjSscg27BTDcw321gHjzyuEjj9IbwP1hPeDqHo2abP0pn5XMR/NhTB/fyo2gv3q0gh1JSkEHCrUuMSG1VxCdxDOtfR1ZDr4AGUwIUACi5JJZMyx1RHUgY3kIn0LBuFQk2EFlv7J3t0+id7JPi86wlJsfm9FUVbQrZR1LrPmQ0hKZfSXC7Fzr5LeD7uGoYBQBCGV56PS2g5ewGy+NkUNbjr9gAAAABJRU5ErkJggg==",mode:"",class:"down posi"},null,512),[[u,L.paused]])])),_:1},8,["onClick"]),r(U,{"scroll-y":"true"},{default:a((()=>[r(B,{class:"lyric"},{default:a((()=>[r(B,{style:o({transform:"translateY("+100*-(L.currentLine-2)+"rpx)"}),class:"lyric_wrapper"},{default:a((()=>[(s(!0),m(A,null,g(L.lyric,((e,l)=>(s(),t(B,{key:l,class:c(L.currentLine===l?"active lyric_item":"lyric_item")},{default:a((()=>[h(P(e.lyric),1)])),_:2},1032,["class"])))),128))])),_:1},8,["style"])])),_:1})])),_:1}),r(B,{class:"playRecommend"},{default:a((()=>[r(B,{class:"playRecommend_title"},{default:a((()=>[r(_,{class:"title_title"},{default:a((()=>[h("喜欢这首歌的人也听")])),_:1}),r(B,{style:{"margin-right":"10rpx"}},{default:a((()=>[r(_,{class:"iconfont",style:{"margin-right":"8rpx"}},{default:a((()=>[h("")])),_:1}),r(_,null,{default:a((()=>[h("一键收听")])),_:1})])),_:1})])),_:1}),(s(!0),m(A,null,g(L.recommendList,((e,l)=>(s(),t(B,{class:"playRecommend_item",key:l},{default:a((()=>[r(k,{src:e.album.picUrl,mode:"widthFix",class:"item_left",onClick:l=>T.gotoPlay(e.id)},null,8,["src","onClick"]),r(B,{class:"item_center",onClick:l=>T.gotoPlay(e.id)},{default:a((()=>[r(B,{class:"name"},{default:a((()=>[h(P(e.album.name),1)])),_:2},1024),r(B,{class:"fullname"},{default:a((()=>[e.sqMusic?(s(),t(k,{key:0,src:G,mode:"widthFix"})):i("",!0),r(_,null,{default:a((()=>[h(P(e.album.artists[0].name),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"]),r(_,{class:"iconfont item_right"},{default:a((()=>[h("")])),_:1})])),_:2},1024)))),128)),r(B,{class:"goodComments"},{default:a((()=>[r(B,{class:"goodComments_title"},{default:a((()=>[h("精彩评论")])),_:1}),(s(!0),m(A,null,g(L.commentList,((e,l)=>(s(),t(B,{class:"goodComments_item",key:l},{default:a((()=>[r(B,{class:"goodComments_user"},{default:a((()=>[r(k,{src:e.user.avatarUrl,mode:"widthFix",class:"user_left"},null,8,["src"]),r(B,{class:"user_center"},{default:a((()=>[r(B,null,{default:a((()=>[h(P(e.user.nickname),1)])),_:2},1024),r(B,null,{default:a((()=>[h(P(e.timeStr)+" "+P(e.ipLocation.location),1)])),_:2},1024)])),_:2},1024),r(_,{class:"iconfont"},{default:a((()=>[h(P(T.compCount(e.likedCount))+" ",1)])),_:2},1024)])),_:2},1024),r(B,{class:"goodComments_content"},{default:a((()=>[h(P(e.content),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})):i("",!0)}],["__scopeId","data-v-009415b5"]]);export{T as default};
