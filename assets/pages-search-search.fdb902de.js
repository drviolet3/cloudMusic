import{y as s,z as e,A as t,n as a,u as l,o,c as r,w as c,i,a as h,b as n,F as d,r as u,d as y,g as f,t as m,e as _,h as k,q as p}from"./index.1e554a58.js";import{_ as g,m as w}from"./MusicHeader.e4e9a46e.js";import{s as S}from"./Search.c638d4cb.js";import{h as H}from"./request.bc33cf91.js";import{_ as b}from"./SQ.7f0d65f0.js";const C=g({data:()=>({hotList:null,keywords:"",searchHistory:s("cloudMusicHistory")||[],isShow:!1,searchResult:null,searchType:1,recommendList:null,bgAudioManager:null}),methods:{handleInput(s,e){this.keywords=s,this.isShow=!!e,this.isShow||(this.searchResult=[]),this.searchType=1,H({url:`/search/suggest?keywords=${this.keywords}&type=mobile`}).then((s=>{var e;console.log(s.data),this.recommendList=null==(e=s.data.result)?void 0:e.allMatch}))},gotoSearch(s){H({url:`/cloudsearch?keywords=${s}`}).then((t=>{console.log(t.data),this.searchHistory.unshift(s);let a=[...new Set(this.searchHistory)];this.searchHistory=a,this.searchHistory.length>10&&(this.searchHistory.length=10),this.searchType=2,e("cloudMusicHistory",Array.from(this.searchHistory)),this.searchResult=t.data.result,this.isShow=!!this.searchResult}))},fillKeywords(s){this.keywords=s,this.$refs.myson.replaceValue(s),this.gotoSearch(s)},clickHistory(s){this.$refs.myson.replaceValue(s),this.gotoSearch(s)},clearAll(){this.searchHistory=[],t("cloudMusicHistory")},gotoPlay(s){a({url:`/pages/play/play?id=${s}`});let e=this.searchResult.songs.map((s=>s.id));console.log(e),this.$store.commit("INIT_TOPLISTIDS",e);const t=l();t.onEnded((()=>{this.$store.commit("NEXT_ID",s),console.log(s)})),this.bgAudioManager=t}},onLoad(){let s=H({url:"/search/hot/detail"});Promise.all([s]).then((s=>{this.hotList=s[0].data.data}))},computed:{},components:{musichead:w,search:S}},[["render",function(s,e,t,a,l,g){const w=_("musichead"),S=_("search",!0),H=i,C=p,T=k;return o(),r(H,{class:"searchPage"},{default:c((()=>[h(w,{title:"搜索",icon:!0,color:"black",iconColor:!0}),h(S,{onMyEvent:g.handleInput,onGotoSearch:g.gotoSearch,ref:"myson"},null,8,["onMyEvent","onGotoSearch"]),l.isShow?(o(),n(d,{key:0},[l.isShow&&2==l.searchType?(o(),r(H,{key:0,class:"searchResult"},{default:c((()=>{var s;return[(o(!0),n(d,null,u(null==(s=l.searchResult)?void 0:s.songs,((s,e)=>(o(),r(H,{class:"result_item",key:e,onClick:e=>g.gotoPlay(s.id)},{default:c((()=>[h(H,{class:"item_left"},{default:c((()=>[h(H,{class:"item_top"},{default:c((()=>[f(m(s.name),1)])),_:2},1024),h(H,{class:"item_bottom"},{default:c((()=>[s.sq?(o(),r(C,{key:0,src:b,mode:"widthFix"})):y("",!0),h(T,{class:"auth"},{default:c((()=>[f(m(s.ar[0].name),1)])),_:2},1024),f("-"),h(T,{class:"name"},{default:c((()=>[f(m(s.name),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),h(T,{class:"iconfont"},{default:c((()=>[f("")])),_:1})])),_:2},1032,["onClick"])))),128))]})),_:1})):y("",!0),l.isShow&&1==l.searchType?(o(),r(H,{key:1,class:"searchSugguest"},{default:c((()=>[h(H,{style:{"font-size":"30rpx",color:"#13cbb6","margin-bottom":"20rpx"}},{default:c((()=>[f('搜索 "'),h(T,{style:{"font-size":"26rpx"}},{default:c((()=>[f(m(l.keywords),1)])),_:1}),f('"')])),_:1}),(o(!0),n(d,null,u(l.recommendList,((s,e)=>(o(),r(H,{class:"sug_item",onClick:e=>g.fillKeywords(s.keyword)},{default:c((()=>[h(T,{class:"iconfont"},{default:c((()=>[f("")])),_:1}),h(T,null,{default:c((()=>[f(m(s.keyword),1)])),_:2},1024)])),_:2},1032,["onClick"])))),256))])),_:1})):y("",!0)],64)):(o(),n(d,{key:1},[h(H,{class:"search_history"},{default:c((()=>[h(H,{class:"history_title"},{default:c((()=>[h(T,null,{default:c((()=>[f("历史记录")])),_:1}),h(T,{class:"iconfont",onClick:g.clearAll},{default:c((()=>[f("")])),_:1},8,["onClick"])])),_:1}),0===l.searchHistory.length?(o(),r(T,{key:0,style:{"font-size":"24rpx",color:"#999",display:"block",width:"100rpx",margin:"0 auto"}},{default:c((()=>[f("暂无历史")])),_:1})):(o(!0),n(d,{key:1},u(l.searchHistory,((s,e)=>(o(),r(T,{class:"search_item",key:e,onClick:e=>g.clickHistory(s)},{default:c((()=>[f(m(s),1)])),_:2},1032,["onClick"])))),128))])),_:1}),h(H,{class:"hotBander"},{default:c((()=>[h(H,{class:"hot_title"},{default:c((()=>[f("热搜榜")])),_:1}),(o(!0),n(d,null,u(l.hotList,((s,e)=>(o(),r(H,{class:"hot_item",key:e,onClick:e=>g.fillKeywords(s.searchWord)},{default:c((()=>[h(T,{class:"order"},{default:c((()=>[f(m(e+1),1)])),_:2},1024),h(H,{class:"item_center"},{default:c((()=>[h(H,null,{default:c((()=>[h(T,null,{default:c((()=>[f(m(s.searchWord),1)])),_:2},1024),s.iconUrl?(o(),r(T,{key:0,class:"em"},{default:c((()=>[f("HOT")])),_:1})):y("",!0)])),_:2},1024),h(H,null,{default:c((()=>[f(m(s.content),1)])),_:2},1024)])),_:2},1024),h(T,{class:"item_count"},{default:c((()=>[f(m(s.score),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})],64))])),_:1})}],["__scopeId","data-v-49690c08"]]);export{C as default};
